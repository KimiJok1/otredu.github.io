<!DOCTYPE html><html lang="fi"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/fullstack/styles.671c43878a72b2c997c8.css">@import url(https://fonts.googleapis.com/css?family=IBM+Plex+Mono:400,500,600);@import url(https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400);code[class*=language-],pre[class*=language-]{color:#fff;background:none;text-shadow:0 -.1em .2em #000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}:not(pre)>code[class*=language-],pre[class*=language-]{background:#4d4033}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border:.3em solid #7a6652;border-radius:.5em;box-shadow:inset 1px 1px .5em #000}:not(pre)>code[class*=language-]{padding:.15em .2em .05em;border-radius:.3em;border:.13em solid #7a6652;box-shadow:inset 1px 1px .3em -.1em #000;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#998066}.token.namespace,.token.punctuation{opacity:.7}.token.boolean,.token.constant,.token.number,.token.property,.token.symbol,.token.tag{color:#d1949e}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#bde052}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f5b83d}.token.atrule,.token.attr-value,.token.keyword{color:#d1949e}.token.important,.token.regex{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.deleted{color:red}.course{position:relative;width:100%}@media (min-width:992px){.course{display:flex;flex-wrap:nowrap;flex-direction:row;align-items:flex-start}}.course p{font-family:IBM Plex Sans,monospace}@media (min-width:640px){.course p{margin-left:1rem}}.course p:not(:last-of-type){margin-bottom:1rem}@media (min-width:640px){.course h1{margin-left:3rem}}.course h2,.course h3,.course h4{padding-bottom:2rem}@media (min-width:640px){.course h2,.course h3,.course h4,.course table{margin-left:1rem}}.course ul{font-family:IBM Plex Sans,monospace}@media (min-width:640px){.course ul{margin-left:2.2rem}}.course h2:not(:first-of-type){margin-top:2rem}.course pre{margin:2rem 0;background-color:#33332d;color:#fff}.course em{font-family:Courier;font-style:normal;background-color:rgba(150,216,224,.6);padding:1px 5px 2px}.course img{border:11px solid transparent}.course .banner,.course .container{position:static}.course .letter{width:4rem;height:4rem;border-width:5px;border-style:solid;border-radius:2.5rem;text-align:center;margin:1rem;line-height:1.3em;transform:translate(-1rem)}@media (min-width:640px){.course .letter{transform:translate(-3rem,4.5rem)}}.course .letter,.course h1{font-size:2.3rem;font-weight:700}.course-content-container{width:100%}.course-content a,.tasks a{border:0;border-bottom-width:2px;border-style:solid;padding:2px}.course-content{width:90%;margin:0 auto;max-width:1200px}@media (min-width:992px){.course-content-inner{padding-left:30%;padding-right:5%}}.tasks a{border-color:#33332d!important}.tasks a:hover{background-color:#fff!important;color:#000!important}.gatsby-highlight-code-line{background-color:rgba(150,216,224,.3);display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:1em}code[class*=language-],pre[class*=language-]{text-shadow:none}.arrow-go-up{width:36px;height:36px;position:fixed;bottom:5%;right:5%;z-index:99999;cursor:pointer}@media (max-width:639px){.arrow-go-up{right:10%}}.part-main__banner{background-position:50%;background-size:50%;padding-bottom:10%;background-repeat:no-repeat}@media (max-width:639px){.part-main__banner{background-position:top;background-size:70%;padding-bottom:30%!important}}.part-intro{font-family:IBM Plex Sans,monospace!important}.part-intro p:not(:last-of-type){padding-bottom:2em}.part-intro__banner{background-size:50%;background-repeat:no-repeat;background-position:100%}@media (max-width:639px){.part-intro__banner{background-position:top;background-size:70%}.part-intro__banner>.container{margin-top:40%}}.part-intro a{border-bottom:1px solid #33332d}.part-intro a:hover{background-color:#fff}.arrow__container{position:relative}.arrow__container:not():first-child{background:none;background-color:none}@media (min-width:640px){.arrow__container:not():first-child{border-left:none}.arrow__container:not():first-child:before{content:"";background:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjwhLS1HZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCktLT48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA0NzcuMTc1IDQ3Ny4xNzUiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQ3Ny4xNzUgNDc3LjE3NSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PHBhdGggZD0iTTM2MC43MzEsMjI5LjA3NWwtMjI1LjEtMjI1LjFjLTUuMy01LjMtMTMuOC01LjMtMTkuMSwwcy01LjMsMTMuOCwwLDE5LjFsMjE1LjUsMjE1LjVsLTIxNS41LDIxNS41DQoJCWMtNS4zLDUuMy01LjMsMTMuOCwwLDE5LjFjMi42LDIuNiw2LjEsNCw5LjUsNGMzLjQsMCw2LjktMS4zLDkuNS00bDIyNS4xLTIyNS4xQzM2NS45MzEsMjQyLjg3NSwzNjUuOTMxLDIzNC4yNzUsMzYwLjczMSwyMjkuMDc1eg0KCQkiLz48L2c+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PC9zdmc+) no-repeat;background-size:contain;position:absolute;top:0;left:0;height:100%;width:100%}}.arrows--horizontal{display:flex;position:relative;margin:0;align-items:flex-start}.arrow__wrapper{display:flex;justify-content:flex-start;align-items:center;margin:0}.arrow__wrapper:first-of-type{border-right:none;z-index:20}.arrow__wrapper:nth-of-type(n+2){margin-left:-4rem;z-index:10}.arrow__wrapper:nth-of-type(n+2) .arrow__rectangle{border-left:none;padding-left:4rem}.arrow__wrapper:nth-of-type(3){z-index:5}.arrow__wrapper:hover .arrow__point,.arrow__wrapper:hover .arrow__rectangle,.arrow__wrapper:hover .arrow__rectangle>a{background-color:#33332d!important;color:#fff!important}.arrow__rectangle{padding:1rem;justify-content:center;align-items:center;border:2px solid #33332d;border-right:none;z-index:2;overflow:hidden;font-family:IBM Plex Sans,monospace;position:relative}@media (max-width:991px){.arrow__rectangle{font-size:1rem}}.arrow__rectangle .bold{font-weight:600}.arrow__rectangle--thick-border{border:3px solid #33332d;border-right:none}.arrow__point{padding:1.25rem;border:2px solid #33332d;border-bottom:none;border-left:none;transform:translate(-1.3rem) rotate(45deg);z-index:1;overflow:hidden}.arrow__point--thick-border{border:3px solid #33332d;border-bottom:none;border-left:none}.arrow__wrapper--stacked{display:flex;justify-content:flex-start;align-items:center;margin:auto auto auto 0}@media (max-width:639px){.arrow__wrapper--stacked .arrow__rectangle{border:none;background-color:transparent!important;padding:0;font-size:1rem;justify-content:unset}.arrow__wrapper--stacked .arrow__rectangle>p>span{border-bottom:1px solid #33332d;margin:auto}.arrow__wrapper--stacked .arrow__rectangle>p>span:hover{background-color:#fff!important;color:#000}.arrow__wrapper--stacked .arrow__point{display:none}}.arrow__wrapper--stacked:nth-of-type(n+2){margin-top:1rem}@media (min-width:640px){.arrow__wrapper--stacked:nth-of-type(n+2){margin-top:-2px}}.arrow__wrapper--stacked .arrow__rectangle{position:relative}@media (min-width:640px){.arrow__wrapper--stacked .arrow__rectangle{padding:1.25rem}}@media (min-width:992px){.arrow__wrapper--stacked .arrow__rectangle{padding:1rem}}.arrow__wrapper--stacked .arrow__point{padding:1.08rem;margin-left:2px}@media (min-width:640px){.arrow__wrapper--stacked .arrow__point{margin-left:unset;padding:1.25rem}}@media (min-width:640px){.arrow__wrapper--stacked:hover .arrow__point,.arrow__wrapper--stacked:hover .arrow__rectangle{background-color:#33332d!important}}@media (min-width:640px){.arrow__wrapper--stacked:hover .arrow--stacked-letter,.arrow__wrapper--stacked:hover .arrow--stacked-title{color:#fff}}.arrow--stacked-title{font-family:IBM Plex Mono,monospace}@media (min-width:640px){.arrow--stacked-title{white-space:nowrap}}.arrow__container--with-link{width:100%!important}@media (max-width:639px){.breadcrumb .arrow__wrapper{display:none}}.breadcrumb .arrow__wrapper:hover .arrow__point,.breadcrumb .arrow__wrapper:hover .arrow__rectangle{background-color:#33332d!important}.breadcrumb .arrow__wrapper:hover .arrow--stacked-letter,.breadcrumb .arrow__wrapper:hover .arrow--stacked-title{color:#fff}.breadcrumb .arrow__rectangle{position:relative}@media (max-width:639px){.breadcrumb .arrow__rectangle{border:none;padding:0;font-size:.7rem;white-space:nowrap;background-color:transparent!important;color:#33332d}}@media (max-width:639px){.breadcrumb .arrow__point{display:none}}.banner{display:flex;width:100%;align-items:center;position:relative;padding:2rem 0;background-color:#96d8e0}@media (min-width:992px){.banner{padding:3.444rem 3.444rem 4.444rem}}.element--flex{display:flex;flex-wrap:wrap}.element--space-around{justify-content:space-around}.element--space-between{justify-content:space-between}.element--column{flex-direction:column}.element--centered{align-items:center;justify-content:center!important}@media (min-width:992px){.element--centered-in-desktop{align-items:center;justify-content:center!important}}@media (min-width:992px){.element--horizontal-half{width:45%}}.element--auto-margin{margin:auto}.element--auto-bottom-margin{margin-bottom:auto}.element--flex-start{align-content:flex-start}.element--no-wrap{flex-wrap:nowrap}.element--relative{position:relative!important}.edit-link>span{border-bottom-width:3px;border-bottom-style:solid;border-bottom-color:inherit}#footer{margin-top:auto}@media (min-width:992px){#footer{align-items:center}}#footer a:hover{background-color:transparent!important}#footer .footer__navigation{display:none}@media (max-width:1199px){#footer .footer__navigation{width:100%;display:block}#footer .footer__navigation-link-container{display:flex;flex-direction:column}}#footer .footer__navigation-link{font-size:1rem;line-height:18px;white-space:nowrap;font-family:IBM Plex Sans,monospace;margin-left:0!important;margin-right:auto}@media (max-width:639px){#footer .footer__navigation-link{line-height:8px}}#footer .footer__navigation-link:hover{color:#fff!important;background-color:#33332d!important}#footer .footer__navigation-link:nth-of-type(n+2){margin-top:2.142rem}@media (min-width:1200px){#footer .footer__navigation{flex-direction:row;flex-wrap:nowrap;justify-content:flex-end}#footer .footer__navigation-link{margin-top:0!important;margin-bottom:auto}#footer .footer__navigation-link:nth-of-type(n+1){margin-right:2.877rem}#footer .footer__navigation-link:last-of-type{margin-right:0!important}}.image__content{position:absolute;top:0;left:0;height:100%;width:100%;-o-object-fit:cover;object-fit:cover}.image--contain .image__content{-o-object-fit:contain;object-fit:contain}.image{overflow:hidden;width:100%;position:relative}@media (min-width:992px){.image{width:40%}}.image .image__container{height:0;position:relative;width:100%;padding-bottom:89.0625%}.image--circle{border-radius:50%}.image--circle .image__content{background-color:#96d8e0}.image--square-big{width:100%}.image--square-big .image__container{width:100%;padding-bottom:100%}.image--extra-small{width:8%}.image--extra-small .image__container{width:100%;padding-bottom:100%}@media (max-width:639px){.image--extra-small{width:calc(33.33333% - 1rem)}}.image--small{width:15%}.image--small .image__container{width:100%;padding-bottom:100%}@media (max-width:639px){.image--small{width:calc(33.33333% - 1rem)}}.image--medium{width:50%}.image--medium .image__container{width:100%;padding-bottom:71.25%}.image--large{width:100%}@media (min-width:992px){.image--large{width:60%}}.image--large .image__container{padding-bottom:59.37%;width:100%}.image--full-width{width:100%}.image--full-width .image__container{padding-bottom:59.37%;width:100%}.image--actual-size{width:100%}.image--actual-size .image__container{height:0;position:relative;width:100%;padding-bottom:60%}.accordion__container{margin-bottom:1rem}.accordion__title{padding-left:2.149rem!important;padding-right:2.149rem!important;font-size:1.111rem!important;font-weight:600}.accordion{background-color:#fff;border:3px solid #33332d;border-radius:5px;color:#444;cursor:pointer;padding:1rem;width:100%;text-align:left;outline:none;font-size:15px;transition:max-width .4s}.accordion:hover,.active{background-color:#96d8e0}.accordion:after{content:"+";font-size:1.5rem;float:right;margin-left:5px}.active{border-color:#fff}.active:after{content:"-";font-size:1.5rem}.panel{background-color:#fff;transition:height .3s;transition-timing-function:ease-in-out;overflow:hidden}.accordion--side-navigation{width:100%;margin-left:unset}.accordion--side-navigation .accordion{border:none;padding:0!important;background-color:transparent!important;color:#33332d!important;border-radius:0}.accordion--side-navigation .accordion__title{font-size:16px!important;font-weight:unset;background-color:transparent}.accordion--side-navigation .accordion__title:hover{background-color:#33332d!important;color:#fff!important}.accordion--side-navigation .panel{padding:1rem 0 0!important;background-color:transparent}.accordion--side-navigation .panel ul{margin-left:1rem}.accordion--side-navigation .accordion:hover,.accordion--side-navigation .active{background-color:#33332d;color:#fff}.accordion--side-navigation .accordion:after,.accordion--side-navigation .active:after{content:""}.body-text:not(:last-of-type){margin-bottom:2.5rem}.body-text__title{color:#33332d;font-size:1.44rem;line-height:1.25em;font-weight:700;margin:0;position:relative;top:50%;transform:translateY(-50%)}.body-text__content:not(:last-of-type){padding-bottom:2em}.bold{font-weight:700}.body-text--no-padding{padding:0!important}@media (min-width:640px){.companies__main-title .body-text__title{font-size:3rem}}.challenge-title{font-size:1.44rem}@media (min-width:992px){.company__logo{width:15%!important}}.developer-story__image{margin-bottom:auto}.developer-story__name{margin-top:4rem;font-size:1.2rem}.developer-story__title{font-size:.9rem}.developer-story__read-more{margin-top:2rem;line-height:1.1rem;width:auto;background:none;color:inherit;padding:0!important;border:none;border-bottom:2px solid #96d8e0;cursor:pointer}.developer-story__read-more:hover{background-color:#96d8e0}.navigation{z-index:2;list-style:none;opacity:0;display:none;margin:0;padding:5%;flex-direction:column;justify-content:center;align-items:center;background:#96d8e0;position:fixed;top:8%;right:5%;transition:opacity .3s ease-in-out;font-weight:200}@media (min-width:1200px){.navigation{display:flex;opacity:1;padding:0;font-weight:400;position:static;background:none;overflow:hidden;flex-direction:row}}@media (max-width:1199px){.navigation__wrapper .language-switcher{margin:20px 0 0}}@media (min-width:1200px){.navigation__wrapper{flex-grow:100}}.navigation__toggle{z-index:3;position:absolute;top:0;right:0;width:50px;height:40px;cursor:pointer;border:none;background:none;outline:none;border-radius:4px}@media (min-width:1200px){.navigation__toggle{display:none}}.navigation__mobile-logo{display:none}.navigation__toggle-icon{top:8px;left:10px}.navigation__toggle-icon,.navigation__toggle-icon:after,.navigation__toggle-icon:before{position:absolute;width:30px;height:3px;transition:all .3s ease;border-radius:4px;background-color:#33332d}.navigation__toggle-icon:after,.navigation__toggle-icon:before{content:"";display:block}.navigation__toggle-icon:before{top:10px}.navigation__toggle-icon:after{top:20px}.is-open--navigation{overflow:hidden;height:100vh}.is-open--navigation .navigation{opacity:1;display:unset}.is-open--navigation .navigation:before{content:"";background-color:#96d8e0;position:absolute;width:25px;height:25px;top:-3px;right:13px;transform:rotate(45deg)}.is-open--navigation .navigation__mobile-logo{display:block;width:30px;height:30px;position:absolute;top:47px;left:5%}@media (min-width:1200px){.is-open--navigation .navigation__mobile-logo{display:none}}.is-open--navigation .navigation__toggle-icon{transform:translate3d(0,10px,0) rotate(45deg)}.is-open--navigation .navigation__toggle-icon,.is-open--navigation .navigation__toggle-icon:after,.is-open--navigation .navigation__toggle-icon:before{background:#33332d}.is-open--navigation .navigation__toggle-icon:before{transform:rotate(-45deg) translate3d(-5.71429px,-6px,0);opacity:0}.is-open--navigation .navigation__toggle-icon:after{transform:translate3d(0,-19px,0) rotate(-90deg)}.navigation__item{margin:22px 0;white-space:nowrap}.navigation__item:first-of-type{margin:0 0 22px}.navigation__item:last-of-type{margin:22px 0 0}@media (min-width:1200px){.navigation__item{margin:0 30px;padding:0!important}.navigation__item:first-of-type{margin:0 30px 0 2rem}.navigation__item:last-of-type{margin:0 0 0 30px}}.content-liftup{position:relative;text-decoration:none}.content-liftup--small{box-sizing:border-box}.content-liftup--small>:last-child{margin-bottom:0}.content-liftup__name{margin-top:1.5rem;color:#33332d;font-weight:700}@media (min-width:992px){.content-liftup__name{margin-top:2rem}}.content-liftup__summary{margin-top:1rem;margin-bottom:3rem;color:#33332d;line-height:28px}.content-liftup__link{text-decoration:none;font-weight:700}.content-liftup .content-liftup__image:after,.content-liftup__link:after{content:"";position:absolute;top:0;left:0;height:100%;width:100%}.content-liftup .content-liftup__image:after{opacity:.5;z-index:2}.triple-border{position:relative;padding:2px;border-radius:5px 0;transition:color .1s ease-in-out,background-color .1s ease-in-out}.triple-border:after,.triple-border:before{z-index:2;content:"";border:2px solid #33332d;border-radius:5px;position:absolute;width:calc(100% + 5px);height:calc(100% + 5px)}.triple-border:before{left:0;top:0}.triple-border:after{bottom:0;right:0}.triple-border__container{position:relative;overflow:hidden;border-radius:3px 0}.triple-border--large-margin{margin:13px;padding:3px}.triple-border--large-margin:after,.triple-border--large-margin:before{content:"";border-width:3px;border-radius:13px;width:calc(100% + 13px);height:calc(100% + 13px)}.triple-border--large-margin .triple-border__container{border-radius:10px 0}.triple-border__logo{padding:.2rem;font-size:1.111rem;font-weight:600}.triple-border__return-tasks{font-size:.9rem;padding:1rem .2rem}.form p{font-family:IBM Plex Sans,monospace;font-size:.9rem;margin-bottom:10px}.form input{padding:1rem;border:1px solid #96d8e0;outline:0}.form input:focus{border:1px solid #33332d}.form .submit{border:3px solid #33332d;background-color:#96d8e0;padding:.7rem 2rem}.form .submit:hover{cursor:pointer;background-color:#33332d;color:#fff}html{font-family:IBM Plex Mono,monospace;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:IBM Plex Mono,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em IBM Plex Mono,monospace;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:IBM Plex Mono,monospace;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:IBM Plex Mono,monospace;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{margin:2rem 0 -.5rem;font-size:1.38316rem}h3,h4{padding:0;color:inherit;font-family:IBM Plex Mono,monospace;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{margin:2rem 0 -1rem;font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:IBM Plex Mono,monospace;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}body,html{margin:0;padding:0;font-family:IBM Plex Mono,monospace;font-weight:500;color:#33332d;font-size:14px;line-height:1.555rem}@media (min-width:992px){body,html{font-size:18px}}.main-wrapper{min-height:100vh;display:flex;flex-direction:column}p{margin:0;text-align:left;line-height:1.5em}a,p{color:#33332d}a{text-decoration:none}.link a{border-bottom:2px solid #96d8e0}.link a:hover{background-color:#96d8e0}.container{position:relative;margin:0 auto;display:flex;flex-wrap:wrap;justify-content:space-between;width:90%;max-width:1200px}@media (max-width:639px){.container{padding:0 20px}}@media (min-width:992px){.container--right{margin-right:5%;width:54%;max-width:719.9856px}}@media (min-width:992px) and (min-width:1200px){.container--right{margin-right:calc((100% - 1200px)/2)}}.hidden{display:none!important}.centered{text-align:center}@media (max-width:639px){.centered--mobile{justify-content:center;align-content:center;align-items:center}}.spacing{margin-top:2rem}@media (max-width:992px) and (min-width:640px){.spacing--tablet{margin-top:5rem!important}}@media (min-width:992px){.spacing{margin-top:5rem}}.spacing--small{margin-top:1rem}@media (min-width:992px){.spacing--small{margin-top:3.444rem}}.spacing--large{margin-top:4rem}@media (min-width:992px){.spacing--large{margin-top:10rem}}.spacing--extra-large{margin-top:4rem}@media (min-width:992px){.spacing--extra-large{margin-top:20rem}}.spacing--after{margin-bottom:2rem}@media (min-width:992px){.spacing--after{margin-bottom:5rem}}@media (max-width:639px){.spacing--after--mobile{margin-bottom:5rem}}@media (min-width:992px){.spacing--after-small{margin-bottom:2.5rem}}.spacing--after-large{margin-bottom:4rem}@media (min-width:992px){.spacing--after-large{margin-bottom:10rem}}@media (max-width:991px){.spacing--mobile{margin-top:2rem}}@media (max-width:1199px){.spacing--mobile--small{margin-top:1.5rem}}@media (max-width:1199px){.spacing--mobile--large{margin-top:3rem}}.col-1{width:100%}@media (min-width:992px){.col-1{width:10%}}.col-2{width:100%}@media (min-width:992px){.col-2{width:20%}}.col-3{width:100%}@media (min-width:992px){.col-3{width:30%}}.col-4{width:100%}@media (min-width:992px){.col-4{width:40%}}.col-5{width:100%}@media (min-width:992px){.col-5{width:50%}}.col-6{width:100%}@media (min-width:992px){.col-6{width:60%}}.col-7{width:100%}@media (min-width:992px){.col-7{width:70%}}.col-8{width:100%}@media (min-width:992px){.col-8{width:80%}}.col-9{width:100%}@media (min-width:992px){.col-9{width:90%}}.col-10{width:100%}@media (min-width:992px){.col-10{width:100%}}@media (min-width:992px){.push-right-1{margin-left:10%}.push-right-2{margin-left:20%}.push-right-3{margin-left:30%}.push-right-4{margin-left:40%}.push-right-5{margin-left:50%}.push-left-1{margin-right:10%}.push-left-2{margin-right:20%}.push-left-3{margin-right:30%}.push-left-4{margin-right:40%}.push-left-5{margin-right:50%}.push-left{margin-right:auto}.push-right{margin-left:auto}}@media (max-width:639px){.col-1--mobile{width:10%!important}.col-2--mobile{width:20%!important}.col-3--mobile{width:30%!important}.col-4--mobile{width:40%!important}.col-5--mobile{width:50%!important}.col-6--mobile{width:60%!important}.col-7--mobile{width:70%!important}.col-8--mobile{width:80%!important}.col-9--mobile{width:90%!important}.col-10--mobile{width:100%!important}.push-right-1--mobile{margin-left:10%!important}.push-right-2--mobile{margin-left:20%!important}.push-right-3--mobile{margin-left:30%!important}.push-right-4--mobile{margin-left:40%!important}.push-right-5--mobile{margin-left:50%!important}.push-left-1--mobile{margin-right:10%!important}.push-left-2--mobile{margin-right:20%!important}.push-left-3--mobile{margin-right:30%!important}.push-left-4--mobile{margin-right:40%!important}.push-left-5--mobile{margin-right:50%!important}.order-0--mobile{order:0}.order-1--mobile{order:1}.order-2--mobile{order:2}.order-3--mobile{order:3}.order-4--mobile{order:4}.order-5--mobile{order:5}.hidden--mobile{display:none}}@media (max-width:1199px){.col-1--tablet{width:10%}.col-2--tablet{width:20%}.col-3--tablet{width:30%}.col-4--tablet{width:40%}.col-5--tablet{width:50%}.col-6--tablet{width:60%}.col-7--tablet{width:70%}.col-8--tablet{width:80%}.col-9--tablet{width:90%}.col-10--tablet{width:100%}.order-0--tablet{order:0}.order-1--tablet{order:1}.order-2--tablet{order:2}.order-3--tablet{order:3}.order-4--tablet{order:4}.order-5--tablet{order:5}.order-0--mobile{order:0}.order-1--mobile{order:1}.order-2--mobile{order:2}.order-3--mobile{order:3}.order-4--mobile{order:4}.order-5--mobile{order:5}.hidden--mobile{display:none}}.centered-vertically{display:flex;flex-direction:column;justify-content:center}.nav-item-hover{text-decoration:none;color:#33332d;font-weight:500;padding:.2em}@media (min-width:640px){.nav-item-hover{font-weight:600}}.nav-item-hover:active,.nav-item-hover:focus,.nav-item-hover:hover{color:#fff;background-color:#33332d!important}.nav-item-hover:active,.nav-item-hover:focus{outline:2px solid #706be4}.flex-fix-aligning:after,.flex-fix-aligning:before{content:"";width:30%;order:2}.index__main-title{font-size:1.571rem}@media (min-width:992px){.index__main-title{font-size:3rem}}.auto-bottom-margin{margin-bottom:auto}@media (min-width:992px){.absolute-top-right--desktop{position:absolute;top:0;right:0}}@media (min-width:640px){.frontpage__hero .image{top:-2em}}@media (min-width:992px){.frontpage__hero{flex-direction:column}.frontpage__hero .image{top:4em}}.heading-font{font-family:IBM Plex Sans,monospace}.about__challenge-button{box-shadow:-3px 5px #33332d;padding:.6rem 1rem;border:3px solid #33332d;font-weight:600}.about__challenge-button:hover{background-color:#33332d;color:#fff;cursor:pointer}.about__challenge-button--turquoise{background-color:#82f7eb}@media (max-width:1199px){.space-between--mobile{justify-content:space-between}}.challenge__banner{display:flex;justify-content:center;margin-bottom:-70px}@media (min-width:640px){.challenge__banner{transform:translateY(-10px)}}@media (min-width:1200px){.challenge__banner{margin-bottom:-370px}}.challenge__banner .image{margin:0;width:70%;transform:translateY(-25%)}@media (min-width:640px){.challenge__banner .image{transform:translateY(-10%)}}@media (min-width:1200px){.challenge__banner .image{transform:translateY(-30%)}}.language-switcher{margin-left:auto;display:flex;width:96px;justify-content:space-between;text-decoration:none}.language-switcher a,.language-switcher span{padding:1px 3px;text-transform:uppercase;border-radius:5px;font-weight:500}.language-switcher a{cursor:pointer;margin:1px}.language-switcher a:hover{background-color:#33332d!important;color:#fff!important}.language-switcher__active-language{border:1px solid #33332d!important}.header{position:-webkit-sticky;position:sticky;z-index:9999999999;top:0;box-sizing:border-box;width:100%;padding-top:1.444rem;padding-bottom:1rem;transition:all .2s ease-in-out}.header--small{pointer-events:none}.header__logo{margin:0 10px;pointer-events:auto}.prev-next__container .separator{display:none}@media (max-width:639px){.prev-next__container .separator{display:block;background-color:#33332d;width:2px!important}}.prev-next__container .prev b,.prev-next__container .prev p{text-align:right}@media (max-width:639px){.prev-next__container .prev p:before{content:"<";margin-right:1rem}}@media (max-width:639px){.prev-next__container .next p:after{content:">";margin-left:1rem}}.scroll-navigation-container{display:none}@media (min-width:992px){.scroll-navigation-container{pointer-events:none;display:block;font-size:16px;position:-webkit-sticky;position:sticky;width:100%;margin-right:-100%;left:0;top:-100px;padding-top:200px}}.scroll-navigation-container-inner{width:90%;margin:0 auto;max-width:1200px}.scroll-navigation{pointer-events:auto;display:flex;width:30%;max-width:30%/.9;height:100%;overflow-y:auto;max-height:calc(100vh - 100px);padding-right:1rem;z-index:199}.scroll-navigation li{list-style-type:none}.scroll-navigation li.selected a,.scroll-navigation li:hover a{background-color:#33332d;color:#fff!important}.scroll-navigation li:before{content:"-"}.left-navigation-link{padding-left:1.2rem;text-indent:-1.2rem;display:block}.left-navigation-link:hover{background-color:#33332d!important;color:#fff!important}.level-h1{font-weight:700;padding-left:2.8rem;text-indent:-2.8rem}.level-h2{padding-left:1.6rem;text-indent:-1.6rem}.some-logo__link{margin:1rem 1rem 0 0;display:inline-block}.some-logo__image{width:1.5rem;height:1.5rem;margin:0}.sub-header{color:#33332d;font-family:IBM Plex Mono,monospace;padding-bottom:1.357rem}@media (min-width:992px){.sub-header{padding-bottom:2.333rem}}</style><meta name="generator" content="Gatsby 2.24.47"/><link rel="sitemap" type="application/xml" href="/fullstack/sitemap.xml"/><title data-react-helmet="true">Fullstack osa4 | </title><meta data-react-helmet="true" name="description" content="Helsingin yliopiston ja Houston Inc:n kaikille avoin ja ilmainen moderniin Javascript-pohjaiseen web-sovelluskehitykseen keskittyvä kurssi. Osallistujilta edellytetään vahvaa ohjelmointirutiinia, pitkäjänteistyyttä ja valmiuksia omatoimiseen ongelmanratkaisuun."/><meta data-react-helmet="true" property="og:title" content="Fullstack osa4 | "/><meta data-react-helmet="true" property="og:description" content="Helsingin yliopiston ja Houston Inc:n kaikille avoin ja ilmainen moderniin Javascript-pohjaiseen web-sovelluskehitykseen keskittyvä kurssi. Osallistujilta edellytetään vahvaa ohjelmointirutiinia, pitkäjänteistyyttä ja valmiuksia omatoimiseen ongelmanratkaisuun."/><meta data-react-helmet="true" name="og:image" content="C:\fullstack\static\seo_image-939e8e249cf62a835ed560f6da4200ad.jpg"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Houston Inc. Consulting oy"/><meta data-react-helmet="true" name="twitter:title" content="Fullstack osa4 | "/><meta data-react-helmet="true" name="twitter:description" content="Helsingin yliopiston ja Houston Inc:n kaikille avoin ja ilmainen moderniin Javascript-pohjaiseen web-sovelluskehitykseen keskittyvä kurssi. Osallistujilta edellytetään vahvaa ohjelmointirutiinia, pitkäjänteistyyttä ja valmiuksia omatoimiseen ongelmanratkaisuun."/><meta data-react-helmet="true" name="twitter:image" content="C:\fullstack\static\seo_image-939e8e249cf62a835ed560f6da4200ad.jpg"/><meta data-react-helmet="true" name="google-site-verification" content="ds9pQKiK3kjhRSHHbf5ccoG-oJggn7Lq4A8uHxM3Mkw"/><meta data-react-helmet="true" name="keywords" content="fullstack, Full stack -websovelluskehitys, course, helsingin yliopisto, tietojenkäsittelytieteen osasto, mooc, mooc.fi, full stack, full stack open, web-sovelluskehitys, web, houston, houston inc, websovelluskehitys, web-sovellus, React, Redux, Node.js, Node, MongoDB, GraphQL, REST, REST api, single page -sovellus, ohjelmointi, university of helsinki, department of computer science, web development, software development, web, web application, single page app, programming, "/><link rel="icon" href="/fullstack/favicon-32x32.png?v=4219a0d81dc3f24fa90ba3de99830fa1" type="image/png"/><link rel="manifest" href="/fullstack/manifest.webmanifest"/><meta name="theme-color" content="#96d8e0"/><link rel="apple-touch-icon" sizes="48x48" href="/fullstack/icons/icon-48x48.png?v=4219a0d81dc3f24fa90ba3de99830fa1"/><link rel="apple-touch-icon" sizes="72x72" href="/fullstack/icons/icon-72x72.png?v=4219a0d81dc3f24fa90ba3de99830fa1"/><link rel="apple-touch-icon" sizes="96x96" href="/fullstack/icons/icon-96x96.png?v=4219a0d81dc3f24fa90ba3de99830fa1"/><link rel="apple-touch-icon" sizes="144x144" href="/fullstack/icons/icon-144x144.png?v=4219a0d81dc3f24fa90ba3de99830fa1"/><link rel="apple-touch-icon" sizes="192x192" href="/fullstack/icons/icon-192x192.png?v=4219a0d81dc3f24fa90ba3de99830fa1"/><link rel="apple-touch-icon" sizes="256x256" href="/fullstack/icons/icon-256x256.png?v=4219a0d81dc3f24fa90ba3de99830fa1"/><link rel="apple-touch-icon" sizes="384x384" href="/fullstack/icons/icon-384x384.png?v=4219a0d81dc3f24fa90ba3de99830fa1"/><link rel="apple-touch-icon" sizes="512x512" href="/fullstack/icons/icon-512x512.png?v=4219a0d81dc3f24fa90ba3de99830fa1"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="canonical" href="https://otredu.github.io/osa4/kayttajien_hallinta" data-baseprotocol="https:" data-basehost="otredu.github.io"/><link as="script" rel="preload" href="/fullstack/webpack-runtime-eb2d79e2bbf27ee8cd6d.js"/><link as="script" rel="preload" href="/fullstack/framework-aaea27cd7ee6870b6744.js"/><link as="script" rel="preload" href="/fullstack/app-7658eb662c2a1d3c42e2.js"/><link as="script" rel="preload" href="/fullstack/styles-89fd2ae28bdf06750a71.js"/><link as="script" rel="preload" href="/fullstack/commons-3617ce9851fa10abe070.js"/><link as="script" rel="preload" href="/fullstack/a31f176ffcf6c7bc4a06afaa62be3bddf0627d34-270cccf9a9fcd85405d4.js"/><link as="script" rel="preload" href="/fullstack/735ea8a36d8cb4026559ff5374a657bb2d7927f8-ba6b96aa1dc8a7b0bf77.js"/><link as="script" rel="preload" href="/fullstack/ffc0360c2cd118b8004ed2a74750fc46aa5ac1d5-4a18ee5a2b9afcdeae3f.js"/><link as="script" rel="preload" href="/fullstack/component---src-templates-content-template-js-32b8c03e25c3ce331706.js"/><link as="fetch" rel="preload" href="/fullstack/page-data\osa4\kayttajien_hallinta\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/fullstack/page-data/sq/d/3128451518.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/fullstack/page-data\app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="main-wrapper"><div class="header " style="background-color:white"><div class="container" style="align-items:center;justify-content:flex-start"><a class="header__logo" href="/fullstack/"><div class="triple-border nav-item-hover " style="padding:0.2em"><div class="triple-border__container triple-border__logo" style="background-color:transparent;z-index:10">{() =&gt; fs}</div></div></a><div class="navigation__wrapper "><button aria-label="Navigation menu" aria-expanded="false" class="navigation__toggle"><div class="navigation__toggle-icon"></div></button><nav><ul class="navigation"><li class="navigation__item "><a class="nav-item-hover" href="/fullstack/about">Kurssista</a></li><li class="navigation__item "><a class="nav-item-hover" href="/fullstack/osa4/kayttajien_hallinta/#course-contents">Kurssimateriaali</a></li><div class="language-switcher"><span class="language-switcher__active-language">fi</span></div></ul></nav></div></div></div><div class="course-container spacing--after"><div class="banner part-main__banner spacing--mobile--small" style="background-image:url(C:\fullstack\static\f800638504cdf371a12947fc31d52030\part-4.svg);background-color:#F7F382"><div class="container spacing--after"><div class="col-10 spacing--after"><div class="arrow__container arrows--horizontal breadcrumb"><div class="arrow__wrapper"><div class="arrow__rectangle  " style="background-color:#F7F382;color:#33332d"><a href="/fullstack/#course-contents">Fullstack</a></div><div class="arrow__point " style="background-color:#F7F382;color:#33332d"></div></div><div class="arrow__wrapper"><div class="arrow__rectangle  " style="background-color:#F7F382;color:#33332d"><a href="/fullstack/osa4">osa 4</a></div><div class="arrow__point " style="background-color:#F7F382;color:#33332d"></div></div><div class="arrow__wrapper"><div class="arrow__rectangle  " style="background-color:#33332d;color:white">Käyttäjien hallinta</div><div class="arrow__point " style="background-color:#33332d;color:white"></div></div></div></div></div></div><div class="course "><div class="scroll-navigation-container "><div class="scroll-navigation-container-inner "><div class="scroll-navigation  element--column" tag="ul"><a class="left-navigation-link" style="border-color:#F7F382" href="/fullstack/osa4/sovelluksen_rakenne_ja_testauksen_alkeet">a Sovelluksen rakenne ja testauksen alkeet</a><a class="left-navigation-link" style="border-color:#F7F382" href="/fullstack/osa4/backendin_testaaminen">b Backendin testaaminen</a><div class="accordion__container col-8 push-right-1 accordion--side-navigation"><button class="accordion accordion__title  " style="background-color:#F7F382;border-color:#F7F382">c Käyttäjien hallinta</button><div class="panel" style="padding:;max-height:0;transition:max-height 0.2s ease-out"><ul></ul></div></div><a class="left-navigation-link" style="border-color:#F7F382" href="/fullstack/osa4/token_perustainen_kirjautuminen">d Token-perustainen kirjautuminen</a></div></div></div><div class="course-content-container "><div class="course-content element--auto-bottom-margin"><div class="course-content-inner "><p class="col-1 letter" style="border-color:#F7F382">c</p><h1 class="sub-header ">Käyttäjien hallinta</h1></div></div><div class="course-content "><div class="course-content-inner ">
<p>Haluamme toteuttaa sovellukseemme käyttäjien hallinnan. Käyttäjät tulee tallettaa tietokantaan ja jokaisesta muistiinpanosta tulee tietää sen luonut käyttäjä. Muistiinpanojen poisto ja editointi tulee olla sallittua ainoastaan muistiinpanot tehneelle käyttäjälle.</p>
<p>Aloitetaan lisäämällä tietokantaan tieto käyttäjistä. Käyttäjän <i>User</i> ja muistiinpanojen <i>Note</i> välillä on yhden suhde moneen -yhteys:</p>
<p><img src="https://yuml.me/a187045b.png"/></p>
<p>Relaatiotietokantoja käytettäessä ratkaisua ei tarvitsisi juuri miettiä. Molemmille olisi oma taulunsa ja muistiinpanoihin liitettäisiin sen luonutta käyttäjää vastaava id vierasavaimeksi (foreign key).</p>
<p>Dokumenttitietokantoja käytettäessä tilanne on kuitenkin toinen, erilaisia tapoja mallintaa tilanne on useita.</p>
<p>Olemassaoleva ratkaisumme tallentaa jokaisen luodun muistiinpanon tietokantaan <i>notes</i>-kokoelmaan eli <i>collectioniin</i>. Jos emme halua muuttaa tätä, lienee luontevinta tallettaa käyttäjät omaan kokoelmaansa, esim. nimeltään <i>users</i>.</p>
<p>Mongossa voidaan kaikkien dokumenttitietokantojen tapaan käyttää olioiden id:itä viittaamaan muissa kokoelmissa talletettaviin dokumentteihin, vastaavasti kuten viiteavaimia käytetään relaatiotietokannoissa.</p>
<p>Dokumenttitietokannat kuten Mongo eivät kuitenkaan tue relaatiotietokantojen <i>liitoskyselyitä</i> vastaavaa toiminnallisuutta, joka mahdollistaisi useaan kokoelmaan kohdistuvan tietokantahaun. Tämä ei tarkalleen ottaen enää pidä paikkaansa, sillä versiosta 3.2. alkaen Mongo on tukenut useampaan kokoelmaan kohdistuvia <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/">lookup-aggregaattikyselyitä</a>. Emme kuitenkaan käsittele niitä kurssilla.</p>
<p>Jos tarvitsemme liitoskyselyitä vastaavaa toiminnallisuutta, tulee se toteuttaa sovelluksen tasolla, eli käytännössä tekemällä tietokantaan useita kyselyitä. Tietyissä tilanteissa mongoose-kirjasto osaa hoitaa liitosten tekemisen, jolloin kysely näyttää mongoosen käyttäjälle toimivan liitoskyselyn tapaan. Mongoose tekee kuitenkin näissä tapauksissa taustalla useamman kyselyn tietokantaan.</p>
<h3>Viitteet kokoelmien välillä</h3>
<p>Jos käyttäisimme relaatiotietokantaa, muistiinpano sisältäisi <i>viiteavaimen</i> sen tehneeseen käyttäjään. Dokumenttitietokannassa voidaan toimia samoin.</p>
<p>Oletetaan että kokoelmassa <i>users</i> on kaksi käyttäjää:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token string">&#x27;mluukkai&#x27;</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token number">123456</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token string">&#x27;hellas&#x27;</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token number">141414</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></div>
<p>Kokoelmassa <i>notes</i> on kolme muistiinpanoa, kaikkien kenttä <i>user</i> viittaa <i>users</i>-kentässä olevaan käyttäjään:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    content<span class="token operator">:</span> <span class="token string">&#x27;HTML is easy&#x27;</span><span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token number">221212</span><span class="token punctuation">,</span>
    user<span class="token operator">:</span> <span class="token number">123456</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    content<span class="token operator">:</span> <span class="token string">&#x27;The most important operations of HTTP protocol are GET and POST&#x27;</span><span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token number">221255</span><span class="token punctuation">,</span>
    user<span class="token operator">:</span> <span class="token number">123456</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    content<span class="token operator">:</span> <span class="token string">&#x27;A proper dinosaur codes with Java&#x27;</span><span class="token punctuation">,</span>
    important<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token number">221244</span><span class="token punctuation">,</span>
    user<span class="token operator">:</span> <span class="token number">141414</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></div>
<p>Mikään ei kuitenkaan määrää dokumenttitietokannoissa, että viitteet on talletettava muistiinpanoihin, ne voivat olla <i>myös</i> (tai ainoastaan) käyttäjien yhteydessä:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token string">&#x27;mluukkai&#x27;</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token number">123456</span><span class="token punctuation">,</span>
    notes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">221212</span><span class="token punctuation">,</span> <span class="token number">221255</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token string">&#x27;hellas&#x27;</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token number">141414</span><span class="token punctuation">,</span>
    notes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">141414</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></div>
<p>Koska käyttäjiin liittyy potentiaalisesti useita muistiinpanoja, niiden id:t talletetaan käyttäjän kentässä <i>notes</i> olevaan taulukkoon.</p>
<p>Dokumenttitietokannat tarjoavat myös radikaalisti erilaisen tavan datan organisointiin; joissain tilanteissa saattaisi olla mielekästä tallettaa muistiinpanot kokonaisuudessa käyttäjien sisälle:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token string">&#x27;mluukkai&#x27;</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token number">123456</span><span class="token punctuation">,</span>
    notes<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        content<span class="token operator">:</span> <span class="token string">&#x27;HTML is easy&#x27;</span><span class="token punctuation">,</span>
        important<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        content<span class="token operator">:</span> <span class="token string">&#x27;The most important operations of HTTP protocol are GET and POST&#x27;</span><span class="token punctuation">,</span>
        important<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token string">&#x27;hellas&#x27;</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token number">141414</span><span class="token punctuation">,</span>
    notes<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        content<span class="token operator">:</span>
          <span class="token string">&#x27;A proper dinosaur codes with Java&#x27;</span><span class="token punctuation">,</span>
        important<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></div>
<p>Muistiinpanot olisivat tässä skeemaratkaisussa siis yhteen käyttäjään alisteisia kenttiä, niillä ei olisi edes omaa identiteettiä, eli id:tä tietokannan tasolla.</p>
<p>Dokumenttitietokantojen yhteydessä skeeman rakenne ei siis ole ollenkaan samalla tavalla ilmeinen kuin relaatiotietokannoissa, ja valittava ratkaisu kannattaa määritellä siten että se tukee parhaalla tavalla sovelluksen käyttötapauksia. Tämä ei luonnollisestikaan ole helppoa, sillä järjestelmän kaikki käyttötapaukset eivät yleensä ole selvillä kun projektin alkuvaiheissa mietitään datan organisointitapaa.</p>
<p>Hieman paradoksaalisesti tietokannan tasolla skeematon Mongo edellyttääkin projektin alkuvaiheissa jopa radikaalimpien datan organisoimiseen liittyvien ratkaisujen tekemistä kuin tietokannan tasolla skeemalliset relaatiotietokannat, jotka tarjoavat keskimäärin kaikkiin tilanteisiin melko hyvin sopivan tavan organisoida dataa.</p>
<h3>Käyttäjien mongoose-skeema</h3>
<p>Päätetään tallettaa käyttäjän yhteyteen myös tieto käyttäjän luomista muistiinpanoista, eli käytännössä muistiinpanojen id:t. Määritellään käyttäjää edustava model tiedostoon <i>models/user.js</i></p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;mongoose&#x27;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> userSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  username<span class="token operator">:</span> String<span class="token punctuation">,</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  passwordHash<span class="token operator">:</span> String<span class="token punctuation">,</span>
  notes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      type<span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span>
      ref<span class="token operator">:</span> <span class="token string">&#x27;Note&#x27;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

userSchema<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#x27;toJSON&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">transform</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">document<span class="token punctuation">,</span> returnedObject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    returnedObject<span class="token punctuation">.</span>id <span class="token operator">=</span> returnedObject<span class="token punctuation">.</span>_id<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">delete</span> returnedObject<span class="token punctuation">.</span>_id
    <span class="token keyword">delete</span> returnedObject<span class="token punctuation">.</span>__v
    <span class="token comment">// the passwordHash should not be revealed</span>
    <span class="token keyword">delete</span> returnedObject<span class="token punctuation">.</span>passwordHash
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&#x27;User&#x27;</span><span class="token punctuation">,</span> userSchema<span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> User</code></pre></div>
<p>Muistiinpanojen id:t on talletettu käyttäjien sisälle taulukkona mongo-id:itä. Määrittely on seuraava</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token punctuation">{</span>
  type<span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span>
  ref<span class="token operator">:</span> <span class="token string">&#x27;Note&#x27;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>kentän tyyppi on <i>ObjectId</i> joka viittaa <i>note</i>-tyyppisiin dokumentteihin. Mongo ei itsessään tiedä mitään siitä, että kyse on kentästä, joka viittaa nimenomaan muistiinpanoihin, kyseessä onkin puhtaasti mongoosen syntaksi.</p>
<p>Laajennetaan tiedostossa <i>model/note.js</i> olevaa muistiinpanon skeemaa siten, että myös muistiinpanossa on tieto sen luoneesta käyttäjästä</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> noteSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  content<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> String<span class="token punctuation">,</span>
    required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minlength<span class="token operator">:</span> <span class="token number">5</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  date<span class="token operator">:</span> Date<span class="token punctuation">,</span>
  important<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">  user<span class="token operator">:</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    type<span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    ref<span class="token operator">:</span> <span class="token string">&#x27;User&#x27;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Relaatiotietokantojen käytänteistä poiketen <i>viitteet on nyt talletettu molempiin dokumentteihin</i>, muistiinpano viittaa sen luoneeseen käyttäjään ja käyttäjä sisältää taulukollisen viitteitä sen luomiin muistiinpanoihin.</p>
<h3>Käyttäjien luominen</h3>
<p>Toteutetaan seuraavaksi route käyttäjien luomista varten. Käyttäjällä on siis <i>username</i> jonka täytyy olla järjestelmässä yksikäsitteinen, nimi eli <i>name</i> sekä <i>passwordHash</i>, eli salasanasta <a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">yksisuuntaisen funktion</a> perusteella laskettu tunniste. Salasanojahan ei ole koskaan viisasta tallentaa tietokantaan selväsanaisena!</p>
<p>Asennetaan salasanojen hashaamiseen käyttämämme <a href="https://github.com/kelektiv/node.bcrypt.js">bcrypt</a>-kirjasto:</p>
<div class="gatsby-highlight" data-language="bash"><pre><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> bcrypt --save</code></pre></div>
<p>Käyttäjien luominen tapahtuu osassa 3 läpikäytyjä <a href="/fullstack/osa3/node_js_ja_express#rest">RESTful</a>-periaatteita seuraten tekemällä HTTP POST -pyyntö polkuun <i>users</i>.</p>
<p>Määritellään käyttäjienhallintaa varten oma <i>router</i> tiedostoon <i>controllers/users.js</i>, ja liitetään se <i>app.js</i>-tiedostossa huolehtimaan polulle <i>/api/users/</i> tulevista pyynnöistä:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> usersRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./controllers/users&#x27;</span><span class="token punctuation">)</span>

<span class="token comment">// ...</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#x27;/api/users&#x27;</span><span class="token punctuation">,</span> usersRouter<span class="token punctuation">)</span></code></pre></div>
<p>Routerin alustava sisältö on seuraava:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> bcrypt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;bcrypt&#x27;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> usersRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;express&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;../models/user&#x27;</span><span class="token punctuation">)</span>

usersRouter<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> body <span class="token operator">=</span> request<span class="token punctuation">.</span>body

  <span class="token keyword">const</span> saltRounds <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token keyword">const</span> passwordHash <span class="token operator">=</span> <span class="token keyword">await</span> bcrypt<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span>password<span class="token punctuation">,</span> saltRounds<span class="token punctuation">)</span>

  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token operator">:</span> body<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
    name<span class="token operator">:</span> body<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    passwordHash<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> savedUser <span class="token operator">=</span> <span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>savedUser<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> usersRouter</code></pre></div>
<p>Tietokantaan siis <i>ei</i> talleteta pyynnön mukana tulevaa salasanaa, vaan funktion <em>bcrypt.hash</em> avulla laskettu <i>hash</i>.</p>
<p>Materiaalin tilamäärä ei valitettavasti riitä käsittelemään sen tarkemmin salasanojen <a href="https://codahale.com/how-to-safely-store-a-password/">tallennuksen perusteita</a>, esim. mitä maaginen luku 10 muuttujan <a href="https://github.com/kelektiv/node.bcrypt.js/#a-note-on-rounds">saltRounds</a> arvona tarkoittaa. Lue linkkien takaa lisää.</p>
<p>Koodissa ei tällä hetkellä ole mitään virheidenkäsittelyä eikä validointeja, eli esim. käyttäjätunnuksen ja salasanan halutun muodon tarkastuksia.</p>
<p>Uutta ominaisuutta voidaan ja kannattaakin joskus testailla käsin esim. postmanilla. Käsin tapahtuva testailu muuttuu kuitenkin nopeasti työlääksi, etenkin kun tulemme pian vaatimaan, että samaa käyttäjätunnusta ei saa tallettaa kantaan kahteen kertaan.</p>
<p>Pienellä vaivalla voimme tehdä automaattisesti suoritettavat testit, jotka helpottavat sovelluksen kehittämistä merkittävästi.</p>
<p>Alustava testi näyttää seuraavalta:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> bcrypt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;bcrypt&#x27;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;../models/user&#x27;</span><span class="token punctuation">)</span>

<span class="token comment">//...</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#x27;when there is initially one user at db&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> passwordHash <span class="token operator">=</span> <span class="token keyword">await</span> bcrypt<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token string">&#x27;sekret&#x27;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span> username<span class="token operator">:</span> <span class="token string">&#x27;root&#x27;</span><span class="token punctuation">,</span> passwordHash <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#x27;creation succeeds with a fresh username&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> usersAtStart <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">usersInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> newUser <span class="token operator">=</span> <span class="token punctuation">{</span>
      username<span class="token operator">:</span> <span class="token string">&#x27;mluukkai&#x27;</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">&#x27;Matti Luukkainen&#x27;</span><span class="token punctuation">,</span>
      password<span class="token operator">:</span> <span class="token string">&#x27;salainen&#x27;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">await</span> api
      <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#x27;/api/users&#x27;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>newUser<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&#x27;Content-Type&#x27;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> usersAtEnd <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">usersInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>usersAtEnd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>usersAtStart<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> usernames <span class="token operator">=</span> usersAtEnd<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">u</span> <span class="token operator">=&gt;</span> u<span class="token punctuation">.</span>username<span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>usernames<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span>newUser<span class="token punctuation">.</span>username<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Testit käyttävät myös tiedostossa <i>tests/test_helper.js</i> määriteltyä apufunktiota <i>usersInDb()</i> tarkastamaan lisäysoperaation jälkeisen tietokannan tilan:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;../models/user&#x27;</span><span class="token punctuation">)</span>

<span class="token comment">// ...</span>

<span class="token keyword">const</span> <span class="token function-variable function">usersInDb</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> users<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">u</span> <span class="token operator">=&gt;</span> u<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  initialNotes<span class="token punctuation">,</span>
  nonExistingId<span class="token punctuation">,</span>
  notesInDb<span class="token punctuation">,</span>
  usersInDb<span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Lohko <i>beforeEach</i> lisää kantaan käyttäjän, jonka username on <i>root</i>. Voimmekin tehdä uuden testin, jolla varmistetaan, että samalla käyttäjätunnuksella ei voi luoda uutta käyttäjää:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#x27;when there is initially one user at db&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#x27;creation fails with proper statuscode and message if username already taken&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> usersAtStart <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">usersInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> newUser <span class="token operator">=</span> <span class="token punctuation">{</span>
      username<span class="token operator">:</span> <span class="token string">&#x27;root&#x27;</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">&#x27;Superuser&#x27;</span><span class="token punctuation">,</span>
      password<span class="token operator">:</span> <span class="token string">&#x27;salainen&#x27;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> api
      <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#x27;/api/users&#x27;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>newUser<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&#x27;Content-Type&#x27;</span><span class="token punctuation">,</span> <span class="token regex">/application\/json/</span><span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>body<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#x27;`username` to be unique&#x27;</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> usersAtEnd <span class="token operator">=</span> <span class="token keyword">await</span> helper<span class="token punctuation">.</span><span class="token function">usersInDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>usersAtEnd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span>usersAtStart<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Testi ei tietenkään mene läpi tässä vaiheessa. Toimimme nyt oleellisesti <a href="https://en.wikipedia.org/wiki/Test-driven_development">TDD:n eli test driven developmentin</a> hengessä, uuden ominaisuuden testi on kirjoitettu ennen ominaisuuden ohjelmointia.</p>
<p>Hoidetaan uniikkiuden tarkastaminen Mongoosen validoinnin avulla. Kuten edellisen osan tehtävässä <a href="/fullstack/osa3/validointi_ja_es_lint#tehtavat-3-19-3-21">3.19</a> mainittiin, Mongoose ei tarjoa valmista validaattoria kentän uniikkiuden tarkastamiseen. Tilanteeseen ratkaisun tarjoaa npm-pakettina asennettava
<a href="https://www.npmjs.com/package/mongoose-unique-validator">mongoose-unique-validator</a>. Suoritetaan asennus</p>
<div class="gatsby-highlight" data-language="bash"><pre><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save mongoose-unique-validator</code></pre></div>
<p>Käyttäjän skeemaa tiedostossa <i>models/user.js</i> tulee muuttaa seuraavasti seuraavasti:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;mongoose&#x27;</span><span class="token punctuation">)</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> uniqueValidator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;mongoose-unique-validator&#x27;</span><span class="token punctuation">)</span></span>
<span class="token keyword">const</span> userSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  username<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> String<span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">    unique<span class="token operator">:</span> <span class="token boolean">true</span></span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  passwordHash<span class="token operator">:</span> String<span class="token punctuation">,</span>
  notes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      type<span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span>
      ref<span class="token operator">:</span> <span class="token string">&#x27;Note&#x27;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="gatsby-highlight-code-line">userSchema<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span>uniqueValidator<span class="token punctuation">)</span></span>
<span class="token comment">// ...</span></code></pre></div>
<p>Voisimme toteuttaa käyttäjien luomisen yhteyteen myös muita tarkistuksia, esim. onko käyttäjätunnus tarpeeksi pitkä, koostuuko se sallituista merkeistä ja onko salasana tarpeeksi hyvä. Jätämme ne kuitenkin vapaaehtoiseksi harjoitustehtäväksi.</p>
<p>Ennen kuin menemme eteenpäin, lisätään sovellukseen alustava versio kaikki käyttäjät palauttavasta käsittelijäfunktiosta:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">usersRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">u</span> <span class="token operator">=&gt;</span> u<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Lista näyttää seuraavalta</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/fullstack/static/485f61a7db35371fea0db42b2bcc1cda/e5ca1/9.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:41.891891891891895%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAwUlEQVQY042Qy27DMAwE/f+fZ1hJ4QRtYyDxq7EiShQp6uE6txZoEQ/Iwx4GXLBi5pQSEd0X/f55+bh01368DeM4f1n0f47zpA0YsJWI5JxLKesPyvor/ke1rTGgGjUMgyVr6CFJ1n08Za21Uqq9taf51PTNeTpPMKHgazmliIgxRinixZPQprngQgy7LoOFt+NxnmZkjDmuu3nKy7LUdd1e20N/6O6dZTD+gWFH7ZxTYN5+TomAwLLbOju2FPml/A25NtJRp4Xr1AAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="9" title="9" src="/fullstack/static/485f61a7db35371fea0db42b2bcc1cda/fcda8/9.png" srcSet="/fullstack/static/485f61a7db35371fea0db42b2bcc1cda/12f09/9.png 148w,
/fullstack/static/485f61a7db35371fea0db42b2bcc1cda/e4a3f/9.png 295w,
/fullstack/static/485f61a7db35371fea0db42b2bcc1cda/fcda8/9.png 590w,
/fullstack/static/485f61a7db35371fea0db42b2bcc1cda/efc66/9.png 885w,
/fullstack/static/485f61a7db35371fea0db42b2bcc1cda/c83ae/9.png 1180w,
/fullstack/static/485f61a7db35371fea0db42b2bcc1cda/e5ca1/9.png 1332w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p>
<p>Sovelluksen tämänhetkinen koodi on kokonaisuudessaan <a href="https://github.com/fullstack-hy2020/part3-notes-backend/tree/part4-7">githubissa</a>, branchissä <i>part4-7</i>.</p>
<h3>Muistiinpanon luominen</h3>
<p>Muistiinpanot luovaa koodia on nyt mukautettava siten, että uusi muistiinpano tulee liitetyksi sen luoneeseen käyttäjään.</p>
<p>Laajennetaan ensin olemassaolevaa toteutusta siten, että tieto muistiinpanon luovan käyttäjän id:stä lähetetään pyynnön rungossa kentän <i>userId</i> arvona:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;../models/user&#x27;</span><span class="token punctuation">)</span>

<span class="token comment">//...</span>

notesRouter<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> body <span class="token operator">=</span> request<span class="token punctuation">.</span>body

<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span>userId<span class="token punctuation">)</span></span>
  <span class="token keyword">const</span> note <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Note</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    content<span class="token operator">:</span> body<span class="token punctuation">.</span>content<span class="token punctuation">,</span>
    important<span class="token operator">:</span> body<span class="token punctuation">.</span>important <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token operator">:</span> body<span class="token punctuation">.</span>important<span class="token punctuation">,</span>
    date<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">    user<span class="token operator">:</span> user<span class="token punctuation">.</span>_id</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> savedNote <span class="token operator">=</span> <span class="token keyword">await</span> note<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="gatsby-highlight-code-line">  user<span class="token punctuation">.</span>notes <span class="token operator">=</span> user<span class="token punctuation">.</span>notes<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>savedNote<span class="token punctuation">.</span>_id<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
  response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>savedNote<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Huomionarvoista on nyt se, että myös <i>user</i>-olio muuttuu. Sen kenttään <i>notes</i> talletetaan luodun muistiinpanon <i>id</i>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> user <span class="token operator">=</span> User<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span>

<span class="token comment">// ...</span>

user<span class="token punctuation">.</span>notes <span class="token operator">=</span> user<span class="token punctuation">.</span>notes<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>savedNote<span class="token punctuation">.</span>_id<span class="token punctuation">)</span>
<span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p>Kokeillaan nyt lisätä uusi muistiinpano</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/fullstack/static/a562436685978cc842c89a5d157a2938/ce0a7/10e.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:31.756756756756754%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA+0lEQVQY022PQU7EMAxFew5uxgE4CzdhxVXYI2aQUEvbmaZJWid24rSN8Qws+Xq2bEvflptxHKdpstYOw9C2bdd1fd87551zOtRwv9Vd82zj6h9f4sNzfHqNDQDEu9Z1DRD8skCA1c0rLDFiCCEiKkiJUiZKqo8R3z79qYdGm5xzuPuZszqRor+0uEyJdBZSwh3hIKgpHHs5apWdhaFudDOnRJxZlxTeNSfMlLasUCYsCXmLVCAqTPtxcyuiNMYYQB7fr5ezOZ3p66sMvXx3crnKAjJbsV5mL8aKcWJmAaypCHFVGn2HuXDITAxwLK7GIAFk2+Rf3W7WP34ATnFUMm2J7vIAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="10e" title="10e" src="/fullstack/static/a562436685978cc842c89a5d157a2938/fcda8/10e.png" srcSet="/fullstack/static/a562436685978cc842c89a5d157a2938/12f09/10e.png 148w,
/fullstack/static/a562436685978cc842c89a5d157a2938/e4a3f/10e.png 295w,
/fullstack/static/a562436685978cc842c89a5d157a2938/fcda8/10e.png 590w,
/fullstack/static/a562436685978cc842c89a5d157a2938/efc66/10e.png 885w,
/fullstack/static/a562436685978cc842c89a5d157a2938/c83ae/10e.png 1180w,
/fullstack/static/a562436685978cc842c89a5d157a2938/ce0a7/10e.png 1590w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p>
<p>Operaatio vaikuttaa toimivan. Lisätään vielä yksi muistiinpano ja mennään kaikkien käyttäjien sivulle:</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/fullstack/static/c60c79686add78ebf57de1711c47fb47/d4e7f/11e.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:43.91891891891892%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAvklEQVQoz52QXQ6CMBCEe/+r6QEMQq2KwdKFAtuWlv5gH42JsXEzD5vdfJPMkG3b5nmGUV6ut1v76J59x3sxSNTmm5RZx2k2xhDvfQhh/2uIlPJ4PLCWCSWWdXHBWW9DKrIjWmvUCAqEgkEP0zpJI513RbBC5D23zsYUffQhhqyUUhG8p32xWENdieoMNRtZXpRT+ffTgCDiuao60YGGdrqjxQLqrTDKaAMNHeiJnxqgHHnurAiOMX6ccvjCzC86ZQ17vfIjXwAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="11e" title="11e" src="/fullstack/static/c60c79686add78ebf57de1711c47fb47/fcda8/11e.png" srcSet="/fullstack/static/c60c79686add78ebf57de1711c47fb47/12f09/11e.png 148w,
/fullstack/static/c60c79686add78ebf57de1711c47fb47/e4a3f/11e.png 295w,
/fullstack/static/c60c79686add78ebf57de1711c47fb47/fcda8/11e.png 590w,
/fullstack/static/c60c79686add78ebf57de1711c47fb47/efc66/11e.png 885w,
/fullstack/static/c60c79686add78ebf57de1711c47fb47/c83ae/11e.png 1180w,
/fullstack/static/c60c79686add78ebf57de1711c47fb47/d4e7f/11e.png 1416w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p>
<p>Huomaamme siis, että käyttäjällä on kaksi muistiinpanoa.</p>
<p>Muistiinpanon luoneen käyttäjän id näkyviin muistiinpanon yhteyteen:</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/fullstack/static/6798064b6620269dd272d7ee515aa4a9/e2d3b/12e.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:54.72972972972974%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABYlAAAWJQFJUiTwAAABRElEQVQoz5VSi2qDMBT1/3+ttJTBiuu6StVVYx4mJjeJmuiubSllY6/DyeWS5zmHJN73YwjWOcZ4nhfnqm4YbyhT2uAkWGes/USwVgIAIckwDOGC+YJpnuIUkWMchzj0oQ/xtvQVCQ5G6Wq1ysrsnWRUU6KbRlPtO+WUsMKP/tvDMQQACw4EcAmtdBKpvZ7/gGSaJinl4fUghDCgoDdudLo3rW3xis5rrMrJznd4qXJLFSBijDfZZVGsN+u0Sp+Lp129O/Jj2qS4A5eu/hfGeO8xBYwGmcQYjDaud8KLGho0TDrCgP2Q04PsGLXW+SlXSoHtoAekG1C5vvtHCxw4VhSP5JZ3S5xykV2dq+12m9VZQY6FyBtDS1kqKzEOfP+q89o89liXw23bEkZO6vTC9nu6R88H/mYH+7ts/CTo/eJ//i8+AAr3e5NWo2iTAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="12e" title="12e" src="/fullstack/static/6798064b6620269dd272d7ee515aa4a9/fcda8/12e.png" srcSet="/fullstack/static/6798064b6620269dd272d7ee515aa4a9/12f09/12e.png 148w,
/fullstack/static/6798064b6620269dd272d7ee515aa4a9/e4a3f/12e.png 295w,
/fullstack/static/6798064b6620269dd272d7ee515aa4a9/fcda8/12e.png 590w,
/fullstack/static/6798064b6620269dd272d7ee515aa4a9/efc66/12e.png 885w,
/fullstack/static/6798064b6620269dd272d7ee515aa4a9/c83ae/12e.png 1180w,
/fullstack/static/6798064b6620269dd272d7ee515aa4a9/e2d3b/12e.png 1466w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p>
<h3>populate</h3>
<p>Haluaisimme API:n toimivan siten, että haettaessa esim. käyttäjien tiedot polulle <i>/api/users</i> tehtävällä HTTP GET -pyynnöllä tulisi käyttäjien tekemien muistiinpanojen id:iden lisäksi näyttää niiden sisältö. Relaatiotietokannoilla toiminnallisuus toteutettaisiin <i>liitoskyselyn</i> avulla.</p>
<p>Kuten aiemmin mainittiin, eivät dokumenttitietokannat tue (kunnolla) eri kokoelmien välisiä liitoskyselyitä. Mongoose-kirjasto osaa kuitenkin tehdä liitoksen puolestamme. Mongoose toteuttaa liitoksen tekemällä useampia tietokantakyselyitä, joten siinä mielessä kyseessä on täysin erilainen tapa kuin relaatiotietokantojen liitoskyselyt, jotka ovat <i>transaktionaalisia</i>, eli liitoskyselyä tehdessä tietokannan tila ei muutu. Mongoosella tehtävä liitos taas on sellainen, että mikään ei takaa sitä, että liitettävien kokoelmien tila on konsistentti, toisin sanoen jos tehdään users- ja notes-kokoelmat liittävä kysely, kokoelmien tila saattaa muuttua kesken Mongoosen liitosoperaation.</p>
<p>Liitoksen tekeminen suoritetaan Mongoosen komennolla <a href="http://mongoosejs.com/docs/populate.html">populate</a>. Päivitetään ensin kaikkien käyttäjien tiedot palauttava route:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">usersRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> User</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">populate</span><span class="token punctuation">(</span><span class="token string">&#x27;notes&#x27;</span><span class="token punctuation">)</span></span>
  response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">u</span> <span class="token operator">=&gt;</span> u<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Funktion <a href="http://mongoosejs.com/docs/populate.html">populate</a> kutsu siis ketjutetaan kyselyä vastaavan metodikutsun (tässä tapauksessa <i>find</i> perään. Populaten parametri määrittelee, että <i>user</i>-dokumenttien <i>notes</i>-kentässä olevat <i>note</i>-olioihin viittaavat <i>id</i>:t korvataan niitä vastaavilla dokumenteilla.</p>
<p>Lopputulos on jo melkein haluamamme kaltainen:</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/fullstack/static/27ee6cc31472f58384b7d7ae2027fe79/b88bf/13ea.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:62.83783783783784%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAABYlAAAWJQFJUiTwAAABYElEQVQoz5WR2W6DQAxF+f8fa/tQ5aFLpFDaRIHJwMDsGzAz1ARSRVVX62L8wLWPTRZjNNaecI0QrhvSkFYqba37JG2soWxoSZ+S46Kv6zHGzDnnfT9dRzrr+0gJBDFlSmlKGca1lFI77QZvequ8Fk5Clk4JJ6RXzAqoqen80MeYYoizGToxxu83m7zaveH8yEsQ4qgfh2EcQUuxZA/vMYB5fsAMWQjZcVqb5sirSqCSl8zyFf4rpUvOQojG2BPCUgG2AlTA1mdsEKAyw6HXUnPDueXwTacpgMzYLWlv7m6fjo/b8mFH8rx92Xf7GTWswOsKAbaY6zEE4AfkDNi96+FHCC86w5hhre6MN1Oc0qJ0Ka61YB/2h+d8iyQq2qJVHdxj2Wc+6Y+azVIqbgW1rFGEaEINgyv86lzNGGMYbrwe4zj9MzJUodeyKGhR8VI4zhybe/7R/FEBCwwPMfx98juj9vKDO3GnDAAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="13ea" title="13ea" src="/fullstack/static/27ee6cc31472f58384b7d7ae2027fe79/fcda8/13ea.png" srcSet="/fullstack/static/27ee6cc31472f58384b7d7ae2027fe79/12f09/13ea.png 148w,
/fullstack/static/27ee6cc31472f58384b7d7ae2027fe79/e4a3f/13ea.png 295w,
/fullstack/static/27ee6cc31472f58384b7d7ae2027fe79/fcda8/13ea.png 590w,
/fullstack/static/27ee6cc31472f58384b7d7ae2027fe79/efc66/13ea.png 885w,
/fullstack/static/27ee6cc31472f58384b7d7ae2027fe79/c83ae/13ea.png 1180w,
/fullstack/static/27ee6cc31472f58384b7d7ae2027fe79/b88bf/13ea.png 1702w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p>
<p>Populaten yhteydessä on myös mahdollista rajata mitä kenttiä sisällytettävistä dokumenteista otetaan mukaan. Rajaus tapahtuu Mongon <a href="https://docs.mongodb.com/manual/tutorial/project-fields-from-query-results/#return-the-specified-fields-and-the-id-field-only">syntaksilla</a>:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">usersRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> User
    <span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">populate</span><span class="token punctuation">(</span><span class="token string">&#x27;notes&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> content<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> date<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">u</span> <span class="token operator">=&gt;</span> u<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Tulos on täsmälleen sellainen kuin haluamme</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/fullstack/static/f5f9a93f9de753a3ac6495d41582ce93/aaf7f/14ea.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:56.75675675675676%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABYlAAAWJQFJUiTwAAABDUlEQVQoz5WS0Y6DIBBF/f8f7Mv2pbqiKAUEZlBAe9FkN/u0LbmQmwkzBwaadV1zzkQshrHHlJOcJuc9IoGYTl1mCUTTtGm9HgfLapqUUgiBmY/PR4MZYzTGDMNgvDFcpVlr0i66sAW/+iUubnVY4RHPJR/Hfux7c9Xw3gspete3thVL3y/fyD837GUv0I+B/pBLKUgex9GQUaSgJ2vwQYNAs2xttPA4iIkGKzwiDUoin2vDhHDiYR+d7SAVFCB5z1UlX6ZGyq+p5Hme27ZFMellTPGzhqlZiSew/UNXrGF9Hef/ZFxYay2lTDmhQR8/Vdd1t6/bXd3FInijkMK7ZHyvDSNvlIi2U4neJL8ATX6BG3g8/g0AAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="14ea" title="14ea" src="/fullstack/static/f5f9a93f9de753a3ac6495d41582ce93/fcda8/14ea.png" srcSet="/fullstack/static/f5f9a93f9de753a3ac6495d41582ce93/12f09/14ea.png 148w,
/fullstack/static/f5f9a93f9de753a3ac6495d41582ce93/e4a3f/14ea.png 295w,
/fullstack/static/f5f9a93f9de753a3ac6495d41582ce93/fcda8/14ea.png 590w,
/fullstack/static/f5f9a93f9de753a3ac6495d41582ce93/efc66/14ea.png 885w,
/fullstack/static/f5f9a93f9de753a3ac6495d41582ce93/c83ae/14ea.png 1180w,
/fullstack/static/f5f9a93f9de753a3ac6495d41582ce93/aaf7f/14ea.png 1668w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p>
<p>Lisätään sopiva käyttäjän tietojen populointi muistiinpanojen yhteyteen:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js">notesRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> notes <span class="token operator">=</span> <span class="token keyword">await</span> Note
    <span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">populate</span><span class="token punctuation">(</span><span class="token string">&#x27;user&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> username<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>notes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">note</span> <span class="token operator">=&gt;</span> note<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Nyt käyttäjän tiedot tulevat muistiinpanon kenttään <i>user</i>.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/fullstack/static/ab1451e8dbee8ffbd723d68c0f621d05/7575b/15ea.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:52.70270270270271%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABYlAAAWJQFJUiTwAAABNElEQVQoz41S2XKDMBDj//+uyVsIbSEhGF/gCx8cqSBtmnY6nezIO/JiYa/sLKXkfWBcnOpLQ1qAMm6ctc4ZwFpwYx2myhgteWpbSGIa7eGQUUr3+z3hF6GIDlp6KQepvHLJ2WhRAW5EBdX5fprn61dkpCHH4sgV65zsfW+TxdL5YcUtlusCrGRZvsUYVVnlbzkxpBBHokkc47z8Fv8Zmfde9hLKszrVukamlo7z+JQYVvjgwxhcGoYNaU4QxymCpCnhE/g6BZ/CZ3EKaC1jjL3sdq1oeNd0vkPb3HHYY6JB/8iomGAAeAHuokMd5uEXq7h4LS6sFpYzS1HF5o+u/HdsjPK9zMv8rM45P1R91Q8dznZ3+I4fnm85wwvQTosg4BlumDmKsz2787IFusf13PCkEvEBt6F9ZoHJ24cAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="15ea" title="15ea" src="/fullstack/static/ab1451e8dbee8ffbd723d68c0f621d05/fcda8/15ea.png" srcSet="/fullstack/static/ab1451e8dbee8ffbd723d68c0f621d05/12f09/15ea.png 148w,
/fullstack/static/ab1451e8dbee8ffbd723d68c0f621d05/e4a3f/15ea.png 295w,
/fullstack/static/ab1451e8dbee8ffbd723d68c0f621d05/fcda8/15ea.png 590w,
/fullstack/static/ab1451e8dbee8ffbd723d68c0f621d05/efc66/15ea.png 885w,
/fullstack/static/ab1451e8dbee8ffbd723d68c0f621d05/c83ae/15ea.png 1180w,
/fullstack/static/ab1451e8dbee8ffbd723d68c0f621d05/7575b/15ea.png 1608w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p>
<p>Korostetaan vielä, että tietokannan tasolla ei siis ole mitään määrittelyä siitä, että esim. muistiinpanojen kenttään <i>user</i> talletetut id:t viittaavat käyttäjä-kokoelman dokumentteihin.</p>
<p>Mongoosen <i>populate</i>-funktion toiminnallisuus perustuu siihen, että olemme määritelleet viitteiden &quot;tyypit&quot; olioiden Mongoose-skeemaan <i>ref</i>-kentän avulla:</p>
<div class="gatsby-highlight" data-language="js"><pre><code class="language-js"><span class="token keyword">const</span> noteSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  content<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> String<span class="token punctuation">,</span>
    required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minlength<span class="token operator">:</span> <span class="token number">5</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  date<span class="token operator">:</span> Date<span class="token punctuation">,</span>
  important<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
  user<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span>
    ref<span class="token operator">:</span> <span class="token string">&#x27;User&#x27;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Sovelluksen tämänhetkinen koodi on kokonaisuudessaan <a href="https://github.com/fullstack-hy2020/part3-notes-backend/tree/part4-8">githubissa</a>, branchissä <i>part4-8</i>.</p>
</div></div></div></div><div class="container spacing element--flex element--centered"><a class="edit-link" target="__BLANK" href="https://github.com/fullstack-hy2020/fullstack-hy2020.github.io/edit/source/src/content/4/fi/osa4c.md"><span>Ehdota muutosta materiaalin sisältöön</span></a></div><div class="container spacing spacing--after-large prev-next__container "><a class="col-4--mobile push-right-1 prev" href="/fullstack/osa4/backendin_testaaminen"><div class=" element--flex element--column"><p>Osa<!-- --> <!-- -->4b</p><b>Edellinen osa</b></div></a><div class="col-1--mobile separator"></div><a class="col-4--mobile push-left-1 next" href="/fullstack/osa4/token_perustainen_kirjautuminen"><div class=" element--flex element--column"><p>Osa<!-- --> <!-- -->4d</p><b>Seuraava osa</b></div></a></div></div><div class="container spacing--after-small spacing--mobile element--flex" id="footer"><div class="col-5 push-right-3 col-10--mobile order-2--mobile order-2--tablet footer__links element--flex element--space-between"><a href="https://www.helsinki.fi/" class="col-5 col-4--mobile spacing--mobile"><div class="image col-6 image--contain"><div class="image__container"><img style="background-color:;background-opacity:0.5" class="image__content" src="/fullstack/static/uoh_centre-a51b43fe8135bcbcead0e64782eb0286.svg" alt="Helsingin yliopiston logo"/></div></div></a><a href="https://www.houston-inc.com/" class="col-5 col-4--mobile spacing--mobile"><div class="image col-6 image--contain"><div class="image__container"><img style="background-color:;background-opacity:0.5" class="image__content" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjI0N3B4IiBoZWlnaHQ9IjgycHgiIHZpZXdCb3g9IjAgMCAyNDcgODIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1My4yICg3MjY0MykgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+DQogICAgPHRpdGxlPmxvZ28vaG91c3RvbjwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+DQogICAgPGRlZnM+DQogICAgICAgIDxwb2x5Z29uIGlkPSJwYXRoLTEiIHBvaW50cz0iMCAwLjAyNjcxOTI2NzMgMTM4LjIwODE2NyAwLjAyNjcxOTI2NzMgMTM4LjIwODE2NyAzNi40NjU0MzgxIDAgMzYuNDY1NDM4MSI+PC9wb2x5Z29uPg0KICAgIDwvZGVmcz4NCiAgICA8ZyBpZD0ibG9nby9ob3VzdG9uIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9ImhvdXN0b25fc2ltcGxlLmVwcy1jb3B5LTMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU0LjU4MTg5MywgMjMuMjYzMDQwKSI+DQogICAgICAgICAgICA8bWFzayBpZD0ibWFzay0yIiBmaWxsPSJ3aGl0ZSI+DQogICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4NCiAgICAgICAgICAgIDwvbWFzaz4NCiAgICAgICAgICAgIDxnIGlkPSJDbGlwLTIiPjwvZz4NCiAgICAgICAgICAgIDxwYXRoIGQ9Ik04Mi44MDUxMjk4LDEzLjUwNjY2MDMgTDgyLjgwNTEyOTgsMjUuNTM2NTUwOSBMODUuOTkzNjI5LDI1LjUzNjU1MDkgTDg1Ljk5MzYyOSwxMy41MDY2NjAzIEw5MC40MDY1NDkzLDEzLjUwNjY2MDMgTDkwLjQwNjU0OTMsMTAuNDQ1Njc4NCBMNzguMzc1MTAzNiwxMC40NDU2Nzg0IEw3OC4zNzUxMDM2LDEzLjUwNjY2MDMgTDgyLjgwNTEyOTgsMTMuNTA2NjYwMyBaIE05Ni40OTEwNDk1LDE3Ljk2MzY4ODUgQzk2LjQ5MTA0OTUsMjAuNTU5NTU3MiA5OC4zMTc4NTU3LDIyLjcwNzk4NDIgMTAwLjg4NjE1NywyMi43MDc5ODQyIEMxMDMuNDU0ODgyLDIyLjcwNzk4NDIgMTA1LjI0NzE5NCwyMC41OTU0NjU3IDEwNS4yNDcxOTQsMTguMDE3OTc1MyBMMTA1LjI0NzE5NCwxOC4wMDAwMjExIEMxMDUuMjQ3MTk0LDE1LjQwNDI5MzcgMTAzLjQyMDUyOSwxMy4yNTU4NjY3IDEwMC44NTIyMjgsMTMuMjU1ODY2NyBDOTguMjgzNTAyMywxMy4yNTU4NjY3IDk2LjQ5MTA0OTUsMTUuMzY4Mzg1MyA5Ni40OTEwNDk1LDE3Ljk0NTczNDMgTDk2LjQ5MTA0OTUsMTcuOTYzNjg4NSBaIE05My4xNDcwNDEzLDE4LjAxNzk3NTMgTDkzLjE0NzA0MTMsMTcuOTgyMDY2OSBDOTMuMTQ3MDQxMywxMy42ODU0OTU2IDk2LjQwNDgxMjcsMTAuMTc2OTMwNiAxMDAuODg2MTU3LDEwLjE3NjkzMDYgQzEwNS4zNjc5MjUsMTAuMTc2OTMwNiAxMDguNTkxMzQzLDEzLjY0OTcyODUgMTA4LjU5MTM0MywxNy45NDU3MzQzIEwxMDguNTkxMzQzLDE3Ljk2MzY4ODUgQzEwOC41OTEzNDMsMjIuMjYwMjU5OCAxMDUuMzMzNTcyLDI1Ljc2ODgyNDcgMTAwLjg1MjIyOCwyNS43Njg4MjQ3IEM5Ni4zNzAzMTgsMjUuNzY4ODI0NyA5My4xNDcwNDEzLDIyLjMxNDEyMjQgOTMuMTQ3MDQxMywxOC4wMTc5NzUzIEw5My4xNDcwNDEzLDE4LjAxNzk3NTMgWiBNNzAuNDExOTEzNywyMi43OTcwNDg1IEM2OC43NTY4NzQyLDIyLjc5NzA0ODUgNjcuMzc4MjE2NiwyMi4wODEyODMxIDY2LjA2ODQwNywyMC45NzE3OTc0IEw2NC4xNzIxODcyLDIzLjMxNjQ0ODQgQzY1LjkxMzE4MDgsMjQuOTI3OTQ1NCA2OC4xMzY2NzYyLDI1LjczMzM0MDQgNzAuMzQzMDY1NiwyNS43MzMzNDA0IEM3My40ODAxMDU1LDI1LjczMzM0MDQgNzUuNjY5MjQ3NiwyNC4wNTAxNjggNzUuNjY5MjQ3NiwyMS4wNjEwMDMgTDc1LjY2OTI0NzYsMjEuMDI1MDk0NSBDNzUuNzIxMTMxLDE4LjM5MzQ1ODggNzQuMDQ4NTYxNSwxNy4zMDE3ODU4IDcxLjEwMTEwMTEsMTYuNDk1ODI1MyBDNjguNTg0NjgzNCwxNS44MzM5MjI2IDY3Ljk2MzkxOTksMTUuNTExMzEyMiA2Ny45NjM5MTk5LDE0LjUwODk4NjIgTDY3Ljk2MzkxOTksMTQuNDczMDc3OCBDNjcuOTYzOTE5OSwxMy43Mzg5MzQxIDY4LjYwMjIxMzUsMTMuMTY2NjYxMSA2OS44MjU2NDQ5LDEzLjE2NjY2MTEgQzcxLjA0OTY0MTgsMTMuMTY2NjYxMSA3Mi4zMDc5OTIxLDEzLjcyMDk3OTkgNzMuNjAwODM3LDE0LjY1MjA1NDUgTDc1LjI1NTU5MzgsMTIuMTQ1OTU2OSBDNzMuNzg5OTkyNSwxMC45MTA2NTAyIDcxLjk4MDcxNjQsMTAuMjMwMzY5MiA2OS44NjA1NjM3LDEwLjIzMDM2OTIgQzY2Ljg5NTcxNDcsMTAuMjMwMzY5MiA2NC43NzU1NjIsMTIuMDM4NjU1NyA2NC43NzU1NjIsMTQuNzc3NTkyNiBMNjQuNzc1NTYyLDE0LjgxMzA3NjkgQzY0Ljc3NTU2MiwxNy44MDI2NjYxIDY2LjY3MTA3NDksMTguNjQ0NTM1IDY5LjU4NDE4MTksMTkuNDMyMTE3MyBDNzIuMDE0NjQ1NiwyMC4wNzY2MzEyIDcyLjUxNDY3NzYsMjAuNTA2MjYwMSA3Mi41MTQ2Nzc2LDIxLjM0NzcwNDkgTDcyLjUxNDY3NzYsMjEuMzgzMDQ3OSBDNzIuNTE0Njc3NiwyMi4yNjAyNTk4IDcxLjcyMjI4ODgsMjIuNzk3MDQ4NSA3MC40MTE5MTM3LDIyLjc5NzA0ODUgTDcwLjQxMTkxMzcsMjIuNzk3MDQ4NSBaIE0zMS4zMzY0Njk3LDE3Ljk2MzY4ODUgQzMxLjMzNjQ2OTcsMjAuNTU5NTU3MiAzMy4xNjM3LDIyLjcwNzk4NDIgMzUuNzMxODU5OSwyMi43MDc5ODQyIEMzOC4zMDAxNjExLDIyLjcwNzk4NDIgNDAuMDkyNDcyNiwyMC41OTU0NjU3IDQwLjA5MjQ3MjYsMTguMDE3OTc1MyBMNDAuMDkyNDcyNiwxOC4wMDAwMjExIEM0MC4wOTI0NzI2LDE1LjQwNDI5MzcgMzguMjY1MjQyMywxMy4yNTU4NjY3IDM1LjY5Njk0MSwxMy4yNTU4NjY3IEMzMy4xMjkyMDUzLDEzLjI1NTg2NjcgMzEuMzM2NDY5NywxNS4zNjgzODUzIDMxLjMzNjQ2OTcsMTcuOTQ1NzM0MyBMMzEuMzM2NDY5NywxNy45NjM2ODg1IFogTTI4LjAwOTcwODksMTguMDE3OTc1MyBMMjguMDA5NzA4OSwxNy45ODIwNjY5IEMyOC4wMDk3MDg5LDEzLjY4NTQ5NTYgMzEuMjY3NDgwMywxMC4xNzY5MzA2IDM1Ljc0ODgyNDUsMTAuMTc2OTMwNiBDNDAuMjMwNzM0MiwxMC4xNzY5MzA2IDQzLjQzNjE5OCwxMy42NDk3Mjg1IDQzLjQ1NDAxMDksMTcuOTQ1NzM0MyBMNDMuNDU0MDEwOSwxNy45NjM2ODg1IEM0My40NTQwMTA5LDIyLjI2MDI1OTggNDAuMTk2MjM5NSwyNS43Njg4MjQ3IDM1LjcxNDg5NTMsMjUuNzY4ODI0NyBDMzEuMjMyNTYxNSwyNS43Njg4MjQ3IDI4LjAwOTcwODksMjIuMzE0MTIyNCAyOC4wMDk3MDg5LDE4LjAxNzk3NTMgTDI4LjAwOTcwODksMTguMDE3OTc1MyBaIE01My44MzA0MTcxLDI1LjczMzM0MDQgQzU3Ljc0Mjg4MTIsMjUuNzMzMzQwNCA2MC4yMDc4Mzk3LDIzLjQ5NTg0OTIgNjAuMjA3ODM5NywxOC45MzA2NzE1IEw2MC4yMDc4Mzk3LDEwLjQyNzE1ODcgTDU3LjAwMTgxMDMsMTAuNDI3MTU4NyBMNTcuMDAxODEwMywxOS4wNzM3Mzk4IEM1Ny4wMDE4MTAzLDIxLjQ3MjY3NzYgNTUuODEyMzA4MSwyMi42OTAwMyA1My44NjQ3NzA0LDIyLjY5MDAzIEM1MS45MTczNzQxLDIyLjY5MDAzIDUwLjcyNzczMDUsMjEuNDE4OTU2MyA1MC43Mjc3MzA1LDE4Ljk2NjU4IEw1MC43Mjc3MzA1LDEwLjQyNzE1ODcgTDQ3LjUzODY2NTgsMTAuNDI3MTU4NyBMNDcuNTM4NjY1OCwxOS4wMzc4MzEzIEM0Ny41Mzg2NjU4LDIzLjQ3Nzg5NSA0OS45MTc5NTMsMjUuNzMzMzQwNCA1My44MzA0MTcxLDI1LjczMzM0MDQgTDUzLjgzMDQxNzEsMjUuNzMzMzQwNCBaIE0zLjE1NDU3LDMzLjE5ODE5NDggTDEzNS4wMzY2MzIsMzMuMTk4MTk0OCBMMTM1LjAzNjYzMiwzLjMwMjQ0NDg4IEwzLjE1NDU3LDMuMzAyNDQ0ODggTDMuMTU0NTcsMzMuMTk4MTk0OCBaIE0wLDM2LjQ3MzkyMDQgTDEzOC4yMDgxNjcsMzYuNDczOTIwNCBMMTM4LjIwODE2NywwLjAyNjcxOTI2NzMgTDAsMC4wMjY3MTkyNjczIEwwLDM2LjQ3MzkyMDQgWiBNMTQuODIzMTE0MywxOS40ODU0MTQ0IEwyMC43MTg2MDA1LDE5LjQ4NTQxNDQgTDIwLjcxODYwMDUsMjUuNTM2NTUwOSBMMjMuOTA3NjY1MiwyNS41MzY1NTA5IEwyMy45MDc2NjUyLDEwLjQ0NTY3ODQgTDIwLjcxODYwMDUsMTAuNDQ1Njc4NCBMMjAuNzE4NjAwNSwxNi40MDYwNTQyIEwxNC44MjMxMTQzLDE2LjQwNjA1NDIgTDE0LjgyMzExNDMsMTAuNDQ1Njc4NCBMMTEuNjM0NzU2NSwxMC40NDU2Nzg0IEwxMS42MzQ3NTY1LDI1LjUzNjU1MDkgTDE0LjgyMzExNDMsMjUuNTM2NTUwOSBMMTQuODIzMTE0MywxOS40ODU0MTQ0IFogTTExNS44NjQ5MjIsMTUuOTQxNTA2NSBMMTIyLjg5NzYwMiwyNS41MzY1NTA5IEwxMjUuNjIwOTg4LDI1LjUzNjU1MDkgTDEyNS42MjA5ODgsMTAuNDQ1Njc4NCBMMTIyLjQ2NjQxOCwxMC40NDU2Nzg0IEwxMjIuNDY2NDE4LDE5LjczNjIwOCBMMTE1LjY1ODM3NywxMC40NDU2Nzg0IEwxMTIuNzEwOTE3LDEwLjQ0NTY3ODQgTDExMi43MTA5MTcsMjUuNTM2NTUwOSBMMTE1Ljg2NDkyMiwyNS41MzY1NTA5IEwxMTUuODY0OTIyLDE1Ljk0MTUwNjUgTDExNS44NjQ5MjIsMTUuOTQxNTA2NSBaIiBpZD0iRmlsbC0xIiBmaWxsPSIjMDAwMTA1IiBtYXNrPSJ1cmwoI21hc2stMikiPjwvcGF0aD4NCiAgICAgICAgPC9nPg0KICAgIDwvZz4NCjwvc3ZnPg==" alt="Houston inc. logo"/></div></div></a></div><div class="col-5 col-5--mobile order-1--mobile order-1--tablet footer__navigation element--flex"><div class="footer__navigation-link-container"><a class="footer__navigation-link nav-item-hover" style="margin-left:4.5rem" href="/fullstack/about">Kurssista</a><a class="footer__navigation-link nav-item-hover" style="margin-left:4.5rem" href="/fullstack/osa4/kayttajien_hallinta/#course-contents">Kurssimateriaali</a></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-135975842-1', 'fullstackopen.com', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/osa4/kayttajien_hallinta";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-c263520f829fc7e005e5.js"],"app":["/app-7658eb662c2a1d3c42e2.js"],"component---src-pages-404-js":["/component---src-pages-404-js-d1a7f55a124633b6ea88.js"],"component---src-pages-about-en-js":["/component---src-pages-about-en-js-6e3cb3f2ccc7ee7c7da7.js"],"component---src-pages-about-js":["/component---src-pages-about-js-dacd3bda243a164b95c3.js"],"component---src-pages-about-zh-js":["/component---src-pages-about-zh-js-05047a49f8fa1f086796.js"],"component---src-pages-challenge-en-js":["/component---src-pages-challenge-en-js-94cae65ccaca06c5bc59.js"],"component---src-pages-challenge-js":["/component---src-pages-challenge-js-97ef3d168c135872a796.js"],"component---src-pages-challenge-zh-js":["/component---src-pages-challenge-zh-js-a638cdb92bff1c872927.js"],"component---src-pages-companies-en-js":["/component---src-pages-companies-en-js-cf9591dccf2364d77fdc.js"],"component---src-pages-companies-js":["/component---src-pages-companies-js-cdc9daf5ef7f75e9d86a.js"],"component---src-pages-companies-zh-js":["/component---src-pages-companies-zh-js-3d8b919d1f7435d12aff.js"],"component---src-pages-faq-en-js":["/component---src-pages-faq-en-js-f1e2318377a38e7f6288.js"],"component---src-pages-faq-js":["/component---src-pages-faq-js-727dbf3ab242ca5aef8d.js"],"component---src-pages-faq-zh-js":["/component---src-pages-faq-zh-js-3408268f775d785f691f.js"],"component---src-pages-index-en-js":["/component---src-pages-index-en-js-1c30d4a72219e9677c1e.js"],"component---src-pages-index-js":["/component---src-pages-index-js-85f09da37a45312587da.js"],"component---src-pages-index-zh-js":["/component---src-pages-index-zh-js-c92497470f3f6baca2c5.js"],"component---src-templates-content-template-js":["/component---src-templates-content-template-js-32b8c03e25c3ce331706.js"],"component---src-templates-part-intro-template-js":["/component---src-templates-part-intro-template-js-421695aa8c153e4f13f5.js"]};/*]]>*/</script><script src="/fullstack/polyfill-c263520f829fc7e005e5.js" nomodule=""></script><script src="/fullstack/component---src-templates-content-template-js-32b8c03e25c3ce331706.js" async=""></script><script src="/fullstack/ffc0360c2cd118b8004ed2a74750fc46aa5ac1d5-4a18ee5a2b9afcdeae3f.js" async=""></script><script src="/fullstack/735ea8a36d8cb4026559ff5374a657bb2d7927f8-ba6b96aa1dc8a7b0bf77.js" async=""></script><script src="/fullstack/a31f176ffcf6c7bc4a06afaa62be3bddf0627d34-270cccf9a9fcd85405d4.js" async=""></script><script src="/fullstack/commons-3617ce9851fa10abe070.js" async=""></script><script src="/fullstack/styles-89fd2ae28bdf06750a71.js" async=""></script><script src="/fullstack/app-7658eb662c2a1d3c42e2.js" async=""></script><script src="/fullstack/framework-aaea27cd7ee6870b6744.js" async=""></script><script src="/fullstack/webpack-runtime-eb2d79e2bbf27ee8cd6d.js" async=""></script></body></html>